"use strict";(self.webpackChunkuxp_photoshop_documentation=self.webpackChunkuxp_photoshop_documentation||[]).push([[46478],{14661:function(e,t,n){n.r(t),n.d(t,{_frontmatter:function(){return r},default:function(){return m}});var a=n(87462),i=n(63366),o=(n(15007),n(64983)),p=n(91515),s=["components"],r={},l={_frontmatter:r},d=p.Z;function m(e){var t=e.components,n=(0,i.Z)(e,s);return(0,o.mdx)(d,(0,a.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,o.mdx)("h1",{id:"writing-a-file-with-uxp"},"Writing a file with UXP"),(0,o.mdx)("p",null,"In this tutorial, you will enhance your plugin by adding a button to export a ",(0,o.mdx)("inlineCode",{parentName:"p"},".tsv")," file that lists all your document's\nlayers including some details."),(0,o.mdx)("h2",{id:"prerequisites"},"Prerequisites"),(0,o.mdx)("p",null,"This tutorial builds on top of the plugin from ",(0,o.mdx)("a",{parentName:"p",href:"../editing-the-document/index.md"},"the previous tutorial"),"."),(0,o.mdx)("h2",{id:"step-1-adjust-the-indexhtml"},"Step 1: Adjust the ",(0,o.mdx)("inlineCode",{parentName:"h2"},"index.html")),(0,o.mdx)("p",null,"In this tutorial, we want to add a new function to the plugin: Exporting a ",(0,o.mdx)("inlineCode",{parentName:"p"},".tsv")," file."),(0,o.mdx)("p",null,"To support this in your UI, adjust your ",(0,o.mdx)("inlineCode",{parentName:"p"},"index.html")," file to include another section with another button ",(0,o.mdx)("inlineCode",{parentName:"p"},'<sp-button id="btnExport" />'),":"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-html"},'<!DOCTYPE html>\n<html>\n  <head>\n    <script src="index.js"><\/script>\n  </head>\n  <style>\n    body {\n      color: white;\n      padding: 0 16px;\n    }\n  </style>\n  <body>\n    <sp-heading>Layers</sp-heading>\n    <sp-heading size="S">Rename layers</sp-heading>\n    <sp-body size="S"> Rename layers to contain their opacity. </sp-body>\n    <sp-button id="btnRename">Rename Layers</sp-button>\n    <sp-heading size="S">Export Report</sp-heading>\n    <sp-body size="S"> Export a report of all layers in the document. </sp-body>\n    <sp-button id="btnExport" variant="secondary">Export Report</sp-button>\n  </body>\n</html>\n')),(0,o.mdx)("p",null,"The resulting panel looks like this:"),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"250px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"158.4%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/uxp-photoshop/static/77e260819f32dc151297beb95e846099/23cfa/panel.webp 250w"],sizes:"(max-width: 250px) 100vw, 250px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/uxp-photoshop/static/77e260819f32dc151297beb95e846099/86700/panel.png 250w"],sizes:"(max-width: 250px) 100vw, 250px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/uxp-photoshop/static/77e260819f32dc151297beb95e846099/86700/panel.png",alt:'Photoshop panel with two buttons: "Rename Layers" and "Export Report"',title:'Photoshop panel with two buttons: "Rename Layers" and "Export Report"',loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("h2",{id:"step-2-add-the-new-function-to-the-indexjs"},"Step 2: Add the new function to the ",(0,o.mdx)("inlineCode",{parentName:"h2"},"index.js")),(0,o.mdx)("p",null,"To export the file, you need to do two things:"),(0,o.mdx)("ol",null,(0,o.mdx)("li",{parentName:"ol"},"create a string with the desired content of the file. This works the same as in the previous tutorials using the DOM APIs from the ",(0,o.mdx)("inlineCode",{parentName:"li"},"window.require('photoshop')")," module."),(0,o.mdx)("li",{parentName:"ol"},"Use the UXP APIs, which you can access using ",(0,o.mdx)("inlineCode",{parentName:"li"},"window.require('uxp')"),", to ask the user for a location to save the file and save a file with the desired content to that location.")),(0,o.mdx)("p",null,"Add the following code to your existing ",(0,o.mdx)("inlineCode",{parentName:"p"},"index.js")," file:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},'// [...]\n\nasync function exportReport() {\n    // create the TSV string\n    let tsvString = "Base name\\tOpacity\\tIs visible";\n\n    const app = window.require("photoshop").app;\n    app.activeDocument.layers.forEach((layer) => {\n        tsvString +=\n            "\\n" +\n            layer.name +\n            "\\t" +\n            layer.opacity +\n            "\\t" +\n            (layer.visible ? "yes" : "no");\n    });\n\n    // save the string to the filesystem\n    const storage = window.require("uxp").storage;\n    const file = await storage.localFileSystem.getFileForSaving("layers.tsv");\n    await file.write(tsvString);\n}\n\ndocument.getElementById("btnExport").addEventListener("click", exportReport);\n')),(0,o.mdx)("p",null,"Note the ",(0,o.mdx)("inlineCode",{parentName:"p"},"async")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"await")," keywords. We need them as the UXP storage APIs are asynchronous. We therefore need\nto ",(0,o.mdx)("inlineCode",{parentName:"p"},"await")," their execution."),(0,o.mdx)("p",null,"After reloading the plugin, you get presented with a file picker when clicking the ",(0,o.mdx)("em",{parentName:"p"},'"Export Report"')," button:"),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"725px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"73.4375%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/uxp-photoshop/static/f02df016108715816990b16bec1289ce/5530d/save-file-dialog.webp 320w","/uxp-photoshop/static/f02df016108715816990b16bec1289ce/0c8fb/save-file-dialog.webp 640w","/uxp-photoshop/static/f02df016108715816990b16bec1289ce/d92b9/save-file-dialog.webp 725w"],sizes:"(max-width: 725px) 100vw, 725px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/uxp-photoshop/static/f02df016108715816990b16bec1289ce/dd4a7/save-file-dialog.png 320w","/uxp-photoshop/static/f02df016108715816990b16bec1289ce/0f09e/save-file-dialog.png 640w","/uxp-photoshop/static/f02df016108715816990b16bec1289ce/f9ac7/save-file-dialog.png 725w"],sizes:"(max-width: 725px) 100vw, 725px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/uxp-photoshop/static/f02df016108715816990b16bec1289ce/f9ac7/save-file-dialog.png",alt:'A native Windows 10 file saving dialog with a file type "TSV" and a pre-selected name "layers.tsv"',title:'A native Windows 10 file saving dialog with a file type "TSV" and a pre-selected name "layers.tsv"',loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("p",null,"Note that this uses the string passed into ",(0,o.mdx)("inlineCode",{parentName:"p"},"getFileForSaving(defaultName)")," as the default name and also derives the supported file type from it."),(0,o.mdx)("p",null,"When you open the exported file in Excel, you can see the list of layers with their properties:"),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"271px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"33.210332103321036%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/uxp-photoshop/static/494fab272596c12a9757bb6eb6bc2868/ecc1b/excel-tsv-preview.webp 271w"],sizes:"(max-width: 271px) 100vw, 271px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/uxp-photoshop/static/494fab272596c12a9757bb6eb6bc2868/63d17/excel-tsv-preview.png 271w"],sizes:"(max-width: 271px) 100vw, 271px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/uxp-photoshop/static/494fab272596c12a9757bb6eb6bc2868/63d17/excel-tsv-preview.png",alt:'Excel table with the columns "Base name", "Opacity", and "Is visible" and the layers as rows',title:'Excel table with the columns "Base name", "Opacity", and "Is visible" and the layers as rows',loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("h2",{id:"next-steps"},"Next steps"),(0,o.mdx)("p",null,"You now know how to use the APIs provided by UXP to interact with the file system. But UXP allows you to do a lot more: Performing network requests, saving preferences using ",(0,o.mdx)("inlineCode",{parentName:"p"},"localStorage"),", get operating system information, open external urls, and much more. We encourage you to take a look at ",(0,o.mdx)("a",{parentName:"p",href:"/uxp-photoshop/src/pages/uxp-api/reference-js/index.md"},"UXP's API Reference")," to get an overview of everything you can do."),(0,o.mdx)("p",null,"To learn how to distribute your plugin, take a look at ",(0,o.mdx)("a",{parentName:"p",href:"/uxp-photoshop/src/pages/guides/distribution/index.md"},"Sharing Your Plugin"),"."))}m.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-getting-started-writing-a-file-index-md-83a9fb5d5357befdfe11.js.map