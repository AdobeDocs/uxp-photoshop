{"version":3,"file":"component---src-pages-ps-reference-media-executeasmodal-md-b0396227568ba02dd561.js","mappings":"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","sources":["webpack://uxp-photoshop-documentation/./src/pages/ps_reference/media/executeasmodal.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/home/runner/work/uxp-photoshop/uxp-photoshop/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"executeasmodal\"\n    }}>{`ExecuteAsModal`}</h1>\n    <p>{`ExecuteAsModal is needed when a plugin wants to make modifications to the Photoshop state. This includes scenarios where the plugin creates or modify documents, or the plugin wishes to update UI or preference state.`}</p>\n    <p>{`ExecuteAsModal is only available to a plugin that is using apiVersion 2 or higher.`}</p>\n    <p>{`Only one plugin at a time can use `}<inlineCode parentName=\"p\">{`executeAsModal`}</inlineCode>{`, and this means that executeAsModal guarantees that the plugin gets exclusive access to Photoshop.`}</p>\n    <p>{`When executeAsModal is active, then Photoshop enters a modal user interaction state. This means that some menu items are disabled.\nIf the modal state lasts a significant amount of time (currently more than two seconds), then a progress bar is shown. The progress bar will identify the plugin that is associated with the modal state, and it will include the ability for the user to cancel the interaction. The following illustrates the progress bar that would be created for a plugin called \"Sample Plugin\". The progress bar is indefinite until the plugin informs Photoshop about its progress.`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"960px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"22.499999999999996%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/uxp-photoshop/static/0a90fc45778667dad31f651d6dbda964/5530d/progress-bar.webp 320w\", \"/uxp-photoshop/static/0a90fc45778667dad31f651d6dbda964/0c8fb/progress-bar.webp 640w\", \"/uxp-photoshop/static/0a90fc45778667dad31f651d6dbda964/a6361/progress-bar.webp 960w\"],\n            \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/uxp-photoshop/static/0a90fc45778667dad31f651d6dbda964/dd4a7/progress-bar.png 320w\", \"/uxp-photoshop/static/0a90fc45778667dad31f651d6dbda964/0f09e/progress-bar.png 640w\", \"/uxp-photoshop/static/0a90fc45778667dad31f651d6dbda964/a91f8/progress-bar.png 960w\"],\n            \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/uxp-photoshop/static/0a90fc45778667dad31f651d6dbda964/a91f8/progress-bar.png\",\n            \"alt\": \"progress bar\",\n            \"title\": \"progress bar\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <p>{`When a plugin is inside a modal scope, then it controls Photoshop. This means that you no longer need to use options such as `}<inlineCode parentName=\"p\">{`modalBehavior`}</inlineCode>{` with `}<inlineCode parentName=\"p\">{`batchPlay`}</inlineCode>{`.`}</p>\n    <br />\n    <h2 {...{\n      \"id\": \"api\"\n    }}>{`API`}</h2>\n    <p>{`ExecuteAsModal is exposed on the Photoshop core module.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`require('photoshop').core.executeAsModal(targetFunction, options);\n`}</code></pre>\n    <p>{`targetFunction is a JavaScript function that will be executed after Photoshop enters a modal state. When the targetFunction completes, then Photoshop will exit the modal state. The targetFunction can be asynchronous.`}</p>\n    <p>{`Only one plugin can be modal at any given time. If another plugin is modal when you call executeAsModal, then executeAsModal will raise an error. It is therefore important to handle errors when calling this method.`}</p>\n    <p>{`It is also recommended that JavaScript awaits on the result from executeAsModal. Without an await, JavaScript will proceed to the subsequent lines of code while Photoshop enters a modal state.`}</p>\n    <p>{`A typical use case is:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`try {\n    await require('photoshop').core.executeAsModal(targetFunction, {\"commandName\": \"My Script Command\"});\n    }\n    catch(e) {\n      if (e.number == 9) {\n          showAlert(\"executeAsModal was rejected (some other plugin is currently inside a modal scope)\");\n      }\n      else {\n        // This case is hit if the targetFunction throws an exception\n      }\n    }\n`}</code></pre>\n    <br />\n    <h3 {...{\n      \"id\": \"arguments\"\n    }}>{`Arguments`}</h3>\n    <p>{`executeAsModal takes the following arguments:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`targetFunction: The JavaScript function to execute after Photoshop enters a modal state.`}</li>\n      <li parentName=\"ol\">{`options: Options describing the request. The following properties are recognized:`}\n        <ol parentName=\"li\">\n          <li parentName=\"ol\">{`commandName (required): A string describing the command. This string is shown in the progress bar UI.`}</li>\n          <li parentName=\"ol\">{`descriptor (optional): An object with command arguments. See documentation for targetFunction below.`}</li>\n          <li parentName=\"ol\">{`interactive (optional): A boolean to toggle `}<a parentName=\"li\" {...{\n              \"href\": \"#interactive-mode\"\n            }}>{`interactive mode`}</a>{`. `}</li>\n        </ol>\n      </li>\n    </ol>\n    <p>{`The JavaScript target function has the following signature:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`async function targetFunction(executionContext, descriptor)\n`}</code></pre>\n    <p>{`The executionContext contains functionality related to managing the modal state.`}</p>\n    <p>{`The descriptor contains the values provided to the descriptor property in the options argument to executeAsModal.`}</p>\n    <p>{`The executionContext contains the following properties:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`isCancelled: A boolean that is true if the user has cancelled the modal interaction.`}</li>\n      <li parentName=\"ul\">{`onCancel: A function property. If JavaScript assigns a function to this property, then this function is executed if the user cancels the modal interaction.`}</li>\n      <li parentName=\"ul\">{`reportProgress: A function that JavaScript can use to customize the progress bar. See below for details.`}</li>\n      <li parentName=\"ul\">{`hostControl: An object containing the following properties:`}\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">{`suspendHistory. A function that can be used to suspend history on a target document. See below for details.`}</li>\n          <li parentName=\"ul\">{`resumeHistory. A function that can be used to resume history on a target document. See below for details.`}</li>\n          <li parentName=\"ul\">{`registerAutoCloseDocument. Register a document to be closed when the modal scope exits. See below for details.`}</li>\n        </ul>\n      </li>\n      <li parentName=\"ul\">{`unregisterAutoCloseDocument. Unregister a document from being closed when the modal scope exits. See below for details.`}</li>\n    </ul>\n    <br />\n    <h3 {...{\n      \"id\": \"user-cancellation\"\n    }}>{`User cancellation`}</h3>\n    <p>{`executeAsModal puts Photoshop into a modal state, and it is important to allow the user to exit this state if the command was invoked by mistake, or if the command is taking too much time.`}</p>\n    <p>{`The user can cancel the operation by pressing the Escape key or using cancellation UI in the progress bar.\nIf the user cancels the interaction, then JavaScript should return from its target function as soon as possible.\nJavaScript can use `}<inlineCode parentName=\"p\">{`isCancelled`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`onCancel`}</inlineCode>{` on the executionContext to get information about the current user cancellation state. In addition to this, Photoshop APIs such as `}<inlineCode parentName=\"p\">{`batchPlay`}</inlineCode>{` will raise an exception if they are invoked from a target function after the user has cancelled the interaction.`}</p>\n    <p>{`The following is an example of a target JavaScript function:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`async function targetFunction(executionContext, descriptor) {\n  let target = {_ref:[{_ref:\"property\", \"_property\": \"hostName\"}, {\"_ref\":\"application\",\"_enum\":\"ordinal\",\"_value\":\"targetEnum\"}]};\n  let command = {\"_obj\": \"get\", \"_target\": target};\n  while (true) {\n    await psAction.batchPlay([command], {});\n  }\n}\nawait require(\"photoshop\").core.executeAsModal(targetFunction, {\"commandName\": \"User Cancel Test\"});\n`}</code></pre>\n    <p>{`This sample will run until the user cancels the interaction. After the user cancels, the modal scope becomes cancelled, and the next call to batchPlay will raise an exception and exit the target function.`}</p>\n    <p>{`Due to the design of the underlying JavaScript runtime, JavaScript can only be cancelled when it is `}<em parentName=\"p\">{`interruptible`}</em>{`. JavaScript can be interrupted when it is waiting on the resolution of a promise. Without the \"await\" keyword in the above example, the JavaScript function would not terminate when the user cancels. Having a tight loop such as the following also does not allow for automatic cancellation of the JavaScript function.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`async function targetFunction(executionContext) {\n  while (true) {\n    calculateSomeDigitsOfPi();\n  }\n}\n`}</code></pre>\n    <p>{`JavaScript that runs for a significant amount of time without an interruption point should regularly query isCancelled on the executionContext. The JavasScript example above can be made cancellable by modifying it to the following:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`async function targetFunction(executionContext) {\n  while (true) {\n    calculateSomeDigitsOfPi();\n    if (executionContext.isCancelled) {\n      throw \"user cancelled\";\n    }\n  }\n}\n`}</code></pre>\n    <p>{`When the JavaScript function uses \"await\" with a Photoshop JavaScript command, then it is automatically terminated if the user cancels the operation. The automatic cancellation relies on JavaScript exceptions, and it is therefore important to not discard exceptions. The following function discards exceptions around batchPlay and will therefore `}<em parentName=\"p\">{`not`}</em>{` be automatically terminated when the user cancels the interaction.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`async function targetFunction(executionContext) {\n  let target = {_ref:[{_ref:\"property\", \"_property\": \"hostName\"}, {\"_ref\":\"application\",\"_enum\":\"ordinal\",\"_value\":\"targetEnum\"}]};\n  let command = {\"_obj\": \"get\", \"_target\": target};\n  while (true) {\n    try {\n       await psAction.batchPlay([command], {});\n    } catch (e) {}\n  }\n}\nawait require(\"photoshop\").core.executeAsModal(targetFunction, {\"commandName\": \"User Cancel Test\"});\n`}</code></pre>\n    <br />\n    <h3 {...{\n      \"id\": \"progress-bar\"\n    }}>{`Progress bar`}</h3>\n    <p>{`By default, Photoshop shows an indeterminate progress bar while a modal scope is active. The progress bar is shown a few seconds after the modal scope is initiated.\nJavaScript can use `}<inlineCode parentName=\"p\">{`reportProgress`}</inlineCode>{` to customize this behavior. To obtain a determinate progress bar, JavaScript can specify a value between 0 and 1 when calling reportProgress. Example:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`async function targetFunction(executionContext) {\n  executionContext.reportProgress({\"value\": 0.3});\n}\n`}</code></pre>\n    <p>{`Setting a value will switch the progress bar to be a determinate progress bar & show the progress bar if it is not yet visible.`}</p>\n    <p>{`JavaScript can change the commandName that is shown in the progress UI by using the \"commandName\" property. This can be used to inform the user about the current stage of the operation. Example:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`    executionContext.reportProgress({\"value\": 0.9, \"commandName\": \"Finishing Up\"});\n`}</code></pre>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"968px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"23.4375%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/uxp-photoshop/static/2e9adeb2a03e5b642b890042878177d5/5530d/progress-bar-2.webp 320w\", \"/uxp-photoshop/static/2e9adeb2a03e5b642b890042878177d5/0c8fb/progress-bar-2.webp 640w\", \"/uxp-photoshop/static/2e9adeb2a03e5b642b890042878177d5/ece56/progress-bar-2.webp 968w\"],\n            \"sizes\": \"(max-width: 968px) 100vw, 968px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/uxp-photoshop/static/2e9adeb2a03e5b642b890042878177d5/dd4a7/progress-bar-2.png 320w\", \"/uxp-photoshop/static/2e9adeb2a03e5b642b890042878177d5/0f09e/progress-bar-2.png 640w\", \"/uxp-photoshop/static/2e9adeb2a03e5b642b890042878177d5/2876f/progress-bar-2.png 968w\"],\n            \"sizes\": \"(max-width: 968px) 100vw, 968px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/uxp-photoshop/static/2e9adeb2a03e5b642b890042878177d5/2876f/progress-bar-2.png\",\n            \"alt\": \"progress bar\",\n            \"title\": \"progress bar\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <p>{`The progress bar is hidden while modal UI is shown.`}</p>\n    <br />\n    <h3 {...{\n      \"id\": \"interactive-mode\"\n    }}>{`Interactive Mode`}</h3>\n    <p><em parentName=\"p\">{`Added in Photoshop 23.3`}</em></p>\n    <p>{`If a plugin requires the accepting of user input or interaction while in a executeAsModal scope, \"Interactive Mode\" may be required.`}</p>\n    <p>{`This mode refrains from displaying a blocking progress dialog to the user, and reduces the number of restrictions that hinder accepting of user input. Use-cases for interactive mode may include:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`allowing users to input data into an invoked modal filter dialog`}</li>\n      <li parentName=\"ul\">{`awaiting user input on a Photoshop workspace, such as Select and Mask`}</li>\n    </ul>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`await require(\"photoshop\").core.executeAsModal(targetFunction, {\"commandName\": \"Apply two filters\", \"interactive\": true});\n`}</code></pre>\n    <p>{`In lieu of the progress bar dialog, users can find the `}<inlineCode parentName=\"p\">{`Cancel Plugin Command`}</inlineCode>{` menu item under the Photoshop `}<inlineCode parentName=\"p\">{`Plugins`}</inlineCode>{` menu. This will interrupt the plugin's executeAsModal scope as described in `}<a parentName=\"p\" {...{\n        \"href\": \"#user-cancellation\"\n      }}>{`User Cancellation`}</a>{`.`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"287px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"50.871080139372815%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/uxp-photoshop/static/b1c378af3bb8a709ec82abbf2e704a1f/be132/eam-pluginmenu-cancel.webp 287w\"],\n            \"sizes\": \"(max-width: 287px) 100vw, 287px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/uxp-photoshop/static/b1c378af3bb8a709ec82abbf2e704a1f/efc29/eam-pluginmenu-cancel.png 287w\"],\n            \"sizes\": \"(max-width: 287px) 100vw, 287px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/uxp-photoshop/static/b1c378af3bb8a709ec82abbf2e704a1f/efc29/eam-pluginmenu-cancel.png\",\n            \"alt\": \"cancel via plugin menu\",\n            \"title\": \"cancel via plugin menu\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <br />\n    <h3 {...{\n      \"id\": \"history-state-suspension\"\n    }}>{`History state suspension`}</h3>\n    <p>{`The hostControl property on the executionContext can be used to suspend and resume history states. While a history state is suspended, Photoshop will coalesce all document changes into a single history state with a custom name.`}</p>\n    <p>{`Example:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`async function historyStateSample(executionContext) {\n    let hostControl = executionContext.hostControl;\n\n    // Get an ID for a target document\n    let documentID = await getTargetDocument();\n\n    // Suspend history state on the target document\n    // This will coalesce all changes into a single history state called\n    // 'Custom Command'\n    let suspensionID = await hostControl.suspendHistory({\n        \"documentID\": documentID,\n        \"name\": \"Custom Command\"\n    });\n\n    // modify the document\n    // . . .\n\n    // resume the history state\n    await hostControl.resumeHistory(suspensionID);\n}\n`}</code></pre>\n    <p>{`The signature for suspendHistory is:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`executionContext.hostControl.suspendHistory(options)\n`}</code></pre>\n    <p>{`The options argument is an object with the following properties:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`documentID: The ID of the document whose history state should be suspended.`}</li>\n      <li parentName=\"ul\">{`name: The name that is used for the history state. This is visible in the History panel.\nsuspendHistory returns a suspension identifier. This identifier should be used with resumeHistory.`}</li>\n    </ul>\n    <p>{`The signature for resumeHistory is:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`executionContext.hostControl.resumeHistory(suspensionID, commit)\n`}</code></pre>\n    <ul>\n      <li parentName=\"ul\">{`suspensionID: the suspension identifier that was returned from suspendHistory.`}</li>\n      <li parentName=\"ul\">{`commit: if true then the current document state is committed and a history state is created. If the second argument is false, then the document state is rolled back to the time when the state was suspended. This argument is optional and the default value is true. Photoshop only creates a history state if the document was modified between the calls to suspendHistory and resumeHistory.`}</li>\n    </ul>\n    <p>{`When the modal scope ends, Photoshop will auto-resume history on any document that is still in a suspended state. If the target function for the modal scope returns normally, then all unsuspended states are committed. If the target function exits via an exception, then all unsuspended history states are cancelled.`}</p>\n    <br />\n    <h3 {...{\n      \"id\": \"notifications\"\n    }}>{`Notifications`}</h3>\n    <p>{`When executeAsModal is active, then Photoshop notifications are silenced similar to when an action is run from the actions panel.`}</p>\n    <p>{`This means that other plugins cannot listen for batchPlay commands that are executed while the modal scope is active.`}</p>\n    <p>{`Plugins can register for notifications related to starting and ending a modal JavaScript scope by registering for the following events:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`\"modalJavaScriptScopeEnter\"`}</li>\n      <li parentName=\"ul\">{`\"modalJavaScriptScopeExit\"`}</li>\n    </ul>\n    <br />\n    <h3 {...{\n      \"id\": \"automatic-document-closing\"\n    }}>{`Automatic document closing`}</h3>\n    <p>{`When the user cancels a modal scope, then JavaScript cannot make any further document changes until it returns from the modal scope. In order to ensure proper clean up of temporary documents, JavaScript can register one or more documents to be automatically closed without saving when the modal scope ends. The following is an example of JavaScript that registers a document to be closed when the modal scope ends:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`async function modalFunction(executionContext) {\n    let hostControl = executionContext.hostControl;\n\n    let docID = await createDocument();\n    await hostControl.registerAutoCloseDocument(docID);\n\n    ...\n}\n`}</code></pre>\n    <p>{`JavaScript can unregister a document from being automatically closed by using unregisterAutoCloseDocument. The following illustrates JavaScript that creates and marks a document as \"auto close\" while the method is running. If the method succeeds then the document is unregistered from the set of auto close documents. This allows JavaScript to create a complete document, or close the document is the user cancels while the script is running.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`async function modalFunction(executionContext) {\n    let hostControl = executionContext.hostControl;\n\n    let docID = await createDocument();\n    await hostControl.registerAutoCloseDocument(docID);\n\n    // Add contents to docID\n\n    ...\n\n    await hostControl.unregisterAutoCloseDocument(docID);\n}\n`}</code></pre>\n    <br />\n    <h3 {...{\n      \"id\": \"notes\"\n    }}>{`Notes`}</h3>\n    <p>{`You can have nested modal scopes. A target function can use executeAsModal to execute another target function.\nAll modal scopes share the same global modal state. This mean that any nested scope can modify the state on the (single) progress bar. Similarly, you can suspend the history state of a document in one scope, and resume the state in another.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"sourceRoot":""}