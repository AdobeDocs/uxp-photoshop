{"version":3,"sources":["webpack://uxp-photoshop-documentation/./src/pages/guides/getting-started/writing-a-file/index.md"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"mappings":"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","file":"component---src-pages-guides-getting-started-writing-a-file-index-md-cf67ddd8377dab71fea7.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/uxp-photoshop/uxp-photoshop/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"writing-a-file-with-uxp\"\n    }}>{`Writing a file with UXP`}</h1>\n    <p>{`In this tutorial, you will enhance your plugin by adding a button to export a `}<inlineCode parentName=\"p\">{`.tsv`}</inlineCode>{` file that lists all your document's\nlayers including some details.`}</p>\n    <h2 {...{\n      \"id\": \"prerequisites\"\n    }}>{`Prerequisites`}</h2>\n    <p>{`This tutorial builds on top of the plugin from `}<a parentName=\"p\" {...{\n        \"href\": \"../editing-the-document/index.md\"\n      }}>{`the previous tutorial`}</a>{`.`}</p>\n    <h2 {...{\n      \"id\": \"step-1-adjust-the-indexhtml\"\n    }}>{`Step 1: Adjust the `}<inlineCode parentName=\"h2\">{`index.html`}</inlineCode></h2>\n    <p>{`In this tutorial, we want to add a new function to the plugin: Exporting a `}<inlineCode parentName=\"p\">{`.tsv`}</inlineCode>{` file.`}</p>\n    <p>{`To support this in your UI, adjust your `}<inlineCode parentName=\"p\">{`index.html`}</inlineCode>{` file to include another section with another button `}<inlineCode parentName=\"p\">{`<sp-button id=\"btnExport\" />`}</inlineCode>{`:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-html\"\n      }}>{`<!DOCTYPE html>\n<html>\n  <head>\n    <script src=\"index.js\"></script>\n  </head>\n  <style>\n    body {\n      color: white;\n      padding: 0 16px;\n    }\n  </style>\n  <body>\n    <sp-heading>Layers</sp-heading>\n    <sp-heading size=\"S\">Rename layers</sp-heading>\n    <sp-body size=\"S\"> Rename layers to contain their opacity. </sp-body>\n    <sp-button id=\"btnRename\">Rename Layers</sp-button>\n    <sp-heading size=\"S\">Export Report</sp-heading>\n    <sp-body size=\"S\"> Export a report of all layers in the document. </sp-body>\n    <sp-button id=\"btnExport\" variant=\"secondary\">Export Report</sp-button>\n  </body>\n</html>\n`}</code></pre>\n    <p>{`The resulting panel looks like this:`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"250px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"158.4%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/uxp-photoshop/static/77e260819f32dc151297beb95e846099/0e2a5/panel.webp 250w\"],\n            \"sizes\": \"(max-width: 250px) 100vw, 250px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/uxp-photoshop/static/77e260819f32dc151297beb95e846099/63868/panel.png 250w\"],\n            \"sizes\": \"(max-width: 250px) 100vw, 250px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/uxp-photoshop/static/77e260819f32dc151297beb95e846099/63868/panel.png\",\n            \"alt\": \"Photoshop panel with two buttons: \\\"Rename Layers\\\" and \\\"Export Report\\\"\",\n            \"title\": \"Photoshop panel with two buttons: \\\"Rename Layers\\\" and \\\"Export Report\\\"\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <h2 {...{\n      \"id\": \"step-2-add-the-new-function-to-the-indexjs\"\n    }}>{`Step 2: Add the new function to the `}<inlineCode parentName=\"h2\">{`index.js`}</inlineCode></h2>\n    <p>{`To export the file, you need to do two things:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`create a string with the desired content of the file. This works the same as in the previous tutorials using the DOM APIs from the `}<inlineCode parentName=\"li\">{`window.require('photoshop')`}</inlineCode>{` module.`}</li>\n      <li parentName=\"ol\">{`Use the UXP APIs, which you can access using `}<inlineCode parentName=\"li\">{`window.require('uxp')`}</inlineCode>{`, to ask the user for a location to save the file and save a file with the desired content to that location.`}</li>\n    </ol>\n    <p>{`Add the following code to your existing `}<inlineCode parentName=\"p\">{`index.js`}</inlineCode>{` file:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`// [...]\n\nasync function exportReport() {\n    // create the TSV string\n    let tsvString = \"Base name\\\\tOpacity\\\\tIs visible\";\n\n    const app = window.require(\"photoshop\").app;\n    app.activeDocument.layers.forEach((layer) => {\n        tsvString +=\n            \"\\\\n\" +\n            layer.name +\n            \"\\\\t\" +\n            layer.opacity +\n            \"\\\\t\" +\n            (layer.visible ? \"yes\" : \"no\");\n    });\n\n    // save the string to the filesystem\n    const storage = window.require(\"uxp\").storage;\n    const file = await storage.localFileSystem.getFileForSaving(\"layers.tsv\");\n    await file.write(tsvString);\n}\n\ndocument.getElementById(\"btnExport\").addEventListener(\"click\", exportReport);\n`}</code></pre>\n    <p>{`Note the `}<inlineCode parentName=\"p\">{`async`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`await`}</inlineCode>{` keywords. We need them as the UXP storage APIs are asynchronous. We therefore need\nto `}<inlineCode parentName=\"p\">{`await`}</inlineCode>{` their execution.`}</p>\n    <p>{`After reloading the plugin, you get presented with a file picker when clicking the `}<em parentName=\"p\">{`\"Export Report\"`}</em>{` button:`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"725px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"73.4375%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/uxp-photoshop/static/f02df016108715816990b16bec1289ce/cb523/save-file-dialog.webp 320w\", \"/uxp-photoshop/static/f02df016108715816990b16bec1289ce/797b9/save-file-dialog.webp 640w\", \"/uxp-photoshop/static/f02df016108715816990b16bec1289ce/8fd7a/save-file-dialog.webp 725w\"],\n            \"sizes\": \"(max-width: 725px) 100vw, 725px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/uxp-photoshop/static/f02df016108715816990b16bec1289ce/72799/save-file-dialog.png 320w\", \"/uxp-photoshop/static/f02df016108715816990b16bec1289ce/6af66/save-file-dialog.png 640w\", \"/uxp-photoshop/static/f02df016108715816990b16bec1289ce/a0209/save-file-dialog.png 725w\"],\n            \"sizes\": \"(max-width: 725px) 100vw, 725px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/uxp-photoshop/static/f02df016108715816990b16bec1289ce/a0209/save-file-dialog.png\",\n            \"alt\": \"A native Windows 10 file saving dialog with a file type \\\"TSV\\\" and a pre-selected name \\\"layers.tsv\\\"\",\n            \"title\": \"A native Windows 10 file saving dialog with a file type \\\"TSV\\\" and a pre-selected name \\\"layers.tsv\\\"\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <p>{`Note that this uses the string passed into `}<inlineCode parentName=\"p\">{`getFileForSaving(defaultName)`}</inlineCode>{` as the default name and also derives the supported file type from it.`}</p>\n    <p>{`When you open the exported file in Excel, you can see the list of layers with their properties:`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"271px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"33.210332103321036%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/uxp-photoshop/static/494fab272596c12a9757bb6eb6bc2868/a15fa/excel-tsv-preview.webp 271w\"],\n            \"sizes\": \"(max-width: 271px) 100vw, 271px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/uxp-photoshop/static/494fab272596c12a9757bb6eb6bc2868/5fce1/excel-tsv-preview.png 271w\"],\n            \"sizes\": \"(max-width: 271px) 100vw, 271px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/uxp-photoshop/static/494fab272596c12a9757bb6eb6bc2868/5fce1/excel-tsv-preview.png\",\n            \"alt\": \"Excel table with the columns \\\"Base name\\\", \\\"Opacity\\\", and \\\"Is visible\\\" and the layers as rows\",\n            \"title\": \"Excel table with the columns \\\"Base name\\\", \\\"Opacity\\\", and \\\"Is visible\\\" and the layers as rows\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <h2 {...{\n      \"id\": \"next-steps\"\n    }}>{`Next steps`}</h2>\n    <p>{`You now know how to use the APIs provided by UXP to interact with the file system. But UXP allows you to do a lot more: Performing network requests, saving preferences using `}<inlineCode parentName=\"p\">{`localStorage`}</inlineCode>{`, get operating system information, open external urls, and much more. We encourage you to take a look at `}<a parentName=\"p\" {...{\n        \"href\": \"/uxp-photoshop/src/pages/uxp/reference-js/index.md\"\n      }}>{`UXP's API Reference`}</a>{` to get an overview of everything you can do.`}</p>\n    <p>{`To learn how to distribute your plugin, take a look at `}<a parentName=\"p\" {...{\n        \"href\": \"/uxp-photoshop/src/pages/guides/distribution/index.md\"\n      }}>{`Sharing Your Plugin`}</a>{`.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}