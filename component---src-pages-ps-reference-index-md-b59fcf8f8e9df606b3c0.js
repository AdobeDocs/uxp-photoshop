"use strict";(self.webpackChunkuxp_photoshop_documentation=self.webpackChunkuxp_photoshop_documentation||[]).push([[82855],{90568:function(e,t,n){n.r(t),n.d(t,{_frontmatter:function(){return p},default:function(){return d}});var a=n(87462),o=n(63366),r=(n(15007),n(64983)),s=n(91515),i=["components"],p={},c={_frontmatter:p},l=s.Z;function d(e){var t=e.components,n=(0,o.Z)(e,i);return(0,r.mdx)(l,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.mdx)("h1",{id:"photoshop-api"},"Photoshop API"),(0,r.mdx)("h2",{id:"overview"},"Overview"),(0,r.mdx)("p",null,"The following line allows you access to the Photoshop DOM via UXP."),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},"const app = require('photoshop').app;\n")),(0,r.mdx)("p",null,"From here, you can open documents, modify them, run menu items, and more."),(0,r.mdx)("h3",{id:"minimum-version"},"Minimum Version"),(0,r.mdx)("p",null,'You will now find minimum version information on properties and methods.  This version tag corresponds to the version of Photoshop where the member was introduced or last updated significantly.\nFor properties, you will find a column "MIN VERSION".  For methods, the version number appears as a tag to the right of the name.'),(0,r.mdx)("h2",{id:"synchronous-vs-asynchronous"},"Synchronous vs Asynchronous"),(0,r.mdx)("p",null,"An important difference between ExtendScript (and CEP) and UXP in Photoshop is that all ExtendScript calls to Photoshop were synchronous. This means they blocked the Photoshop UI while they were executing. In UXP, a method call is ",(0,r.mdx)("em",{parentName:"p"},"asynchronous"),", and does not block the UI thread."),(0,r.mdx)("p",null,"For a smooth transition between the ExtendScript DOM and the UXP DOM, all properties (get and set) in the API were designed to be ",(0,r.mdx)("em",{parentName:"p"},"synchronous")," and do not need to be awaited. It is worth noting that they are, in the background, asynchronous in nature."),(0,r.mdx)("h2",{id:"working-with-photoshop-objects"},"Working with Photoshop Objects"),(0,r.mdx)("h3",{id:"photoshop-application"},"Photoshop Application"),(0,r.mdx)("p",null,"Through the ",(0,r.mdx)("a",{parentName:"p",href:"#overview"},(0,r.mdx)("inlineCode",{parentName:"a"},"app"))," object, you can access the rest of Photoshop's objects and methods."),(0,r.mdx)("p",null,"The currently-active document is obtained like this:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},"const doc = app.activeDocument;\n")),(0,r.mdx)("p",null,"And you can get an array of all open documents like this:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},"const allDocuments = app.documents;\n")),(0,r.mdx)("p",null,"See more properties and methods in ",(0,r.mdx)("inlineCode",{parentName:"p"},"app")," under ",(0,r.mdx)("a",{parentName:"p",href:"./classes/photoshop/"},"Photoshop"),"."),(0,r.mdx)("h3",{id:"detour---executeasmodal"},"Detour - ExecuteAsModal"),(0,r.mdx)("p",null,'A key concept to understand before diving straight into Photoshop UXP plugin development is what we have termed "execute as modal". Any and all commands that may ',(0,r.mdx)("strong",{parentName:"p"},"modify the document"),", or the ",(0,r.mdx)("strong",{parentName:"p"},"application state"),", must utilize executeAsModal."),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},"async function makeDefaultDocument(executionContext) {\n  const app = require('photoshop').app;\n  let myDoc = await app.createDocument({preset: \"My Web Preset 1\"});\n}\n\nawait require('photoshop').core.executeAsModal(makeDefaultDocument);\n")),(0,r.mdx)("p",null,"As you may notice, this restriction could encompass much of your plugin's functionality! There are many benefits for this model, however. A more detailed explanation is provided in the ",(0,r.mdx)("a",{parentName:"p",href:"./media/executeasmodal/"},"Execute as Modal documentation"),"."),(0,r.mdx)("h3",{id:"document"},"Document"),(0,r.mdx)("p",null,"Represents a single, open Photoshop document. From this object, you can access the document's layers, dimensions, resolution, etc. You can crop it, add/delete/duplicate layers, resize, rotate, and save it."),(0,r.mdx)("p",null,"Get the dimensions of the active document:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},"const app = require('photoshop').app;\nconst myDoc = app.activeDocument;\nconst height = myDoc.height;\nconst width = myDoc.width;\nconst resolution = myDoc.resolution;\nconsole.log(`Doc size is ${width} x ${height}. Resolution is ${resolution}`);\n")),(0,r.mdx)("p",null,"Flatten all currently open documents:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},"const app = require('photoshop').app;\nconst toFlatten = app.documents;\nasync function flattenThem(executionContext) {\n  toFlatten.forEach((photoshopDoc) => {\n    photoshopDoc.flatten();\n  });\n};\n\nawait require('photoshop').core.executeAsModal(flattenThem);\n")),(0,r.mdx)("p",null,"Create a layer:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},"const app = require('photoshop').app;\nasync function newColorDodgeLayer(executionContext) {\n  await app.activeDocument.createLayer({ name: \"myLayer\", opacity: 80, blendMode: \"colorDodge\" });\n};\n\nawait require('photoshop').core.executeAsModal(newColorDodgeLayer);\n")),(0,r.mdx)("p",null,"See more properties and methods regarding ",(0,r.mdx)("inlineCode",{parentName:"p"},"Document")," under ",(0,r.mdx)("a",{parentName:"p",href:"./classes/document/"},"Document")," and ",(0,r.mdx)("a",{parentName:"p",href:"./classes/documents"},"Documents"),"."),(0,r.mdx)("h3",{id:"layer"},"Layer"),(0,r.mdx)("p",null,"Represents a Layer, or a group of Layers. This object is tied to a particular ",(0,r.mdx)("a",{parentName:"p",href:"#Document"},"Document"),"."),(0,r.mdx)("p",null,"Decrease a layer's opacity and bring it to the front:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},"const app = require('photoshop').app;\nconst doc = app.activeDocument;\nfunction bringActiveLayerToFront(executionContext) {\n  const layer = doc.activeLayers[0];\n  layer.opacity = layer.opacity - 10;\n  layer.bringToFront();\n};\n\nawait require('photoshop').core.executeAsModal(bringActiveLayerToFront);\n")),(0,r.mdx)("p",null,"Scale down each layer whose name includes 'smaller'"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},"const app = require('photoshop').app;\nconst doc = app.activeDocument;\nconst layers = doc.layers;\nasync function scaleLayers(executionContext) {\n  for (layer of layers) {\n    if (layer.name.includes('smaller')) {\n      await layer.scale(80, 80);\n    }\n  }\n};\n\nawait require('photoshop').core.executeAsModal(scaleLayers);\n")),(0,r.mdx)("p",null,"Note that a layer's ",(0,r.mdx)("inlineCode",{parentName:"p"},"kind")," property can be ",(0,r.mdx)("inlineCode",{parentName:"p"},"GROUP")," for a Group layer (a layer or folder containing multiple layers). To access the layers in a Group layer, use the ",(0,r.mdx)("inlineCode",{parentName:"p"},"layers")," property, and the ",(0,r.mdx)("inlineCode",{parentName:"p"},"parent")," property to navigate the layer list tree."),(0,r.mdx)("p",null,"See more properties and methods for ",(0,r.mdx)("inlineCode",{parentName:"p"},"Layer")," under ",(0,r.mdx)("a",{parentName:"p",href:"./classes/layer/"},"Layer")," and ",(0,r.mdx)("a",{parentName:"p",href:"./classes/layers/"},"Layers"),"."),(0,r.mdx)("h3",{id:"actions-and-actionsets"},"Actions and ActionSets"),(0,r.mdx)("p",null,"Many Photoshop users make heavy use of the ",(0,r.mdx)("inlineCode",{parentName:"p"},"Actions")," panel. Actions are essentially macros that can be recorded and played back to script commands and tools that you use frequently. Actions are grouped into ",(0,r.mdx)("inlineCode",{parentName:"p"},"Action Sets"),", similar to the way layers can be grouped into Group layers."),(0,r.mdx)("p",null,"The Actions object allows you to delete, duplicate, rename, and play actions. There is no current way to ",(0,r.mdx)("em",{parentName:"p"},"create")," an action using UXP."),(0,r.mdx)("p",null,"Similarly to Actions, the ActionSet object allows you to delete, duplicate, rename, and play Action Sets. There is no current way to ",(0,r.mdx)("em",{parentName:"p"},"create")," an Action Set."),(0,r.mdx)("p",null,"Note that Actions and Action Sets exist app-wide; they're not tied to a specific Document."),(0,r.mdx)("p",null,"Here's an example that finds a particular Action in the default Action Set, then plays it if it exists:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},"const app = require('photoshop').app;\nconst allActionSets = app.actionTree;\nconst firstActionSet = allActionSets[0];\nlet actions = new Map(); // a JS Map allows easy \"find by name\" operations\nfirstActionSet.actions.forEach((action) => { actions.set(action.name, action)});\nconst myAction = actions.get(\"Wood Frame - 50 pixel\");\nif (myAction) { // user may have deleted this action\n  async function playMyAction(executionContext) {\n    await myAction.play();\n  }\n  await require('photoshop').core.executeAsModal(playMyAction);\n}\n")),(0,r.mdx)("p",null,"See more properties and methods for ",(0,r.mdx)("inlineCode",{parentName:"p"},"Action")," under ",(0,r.mdx)("a",{parentName:"p",href:"./classes/action/"},"Action")," and ",(0,r.mdx)("a",{parentName:"p",href:"./classes/actionset/"},"ActionSet")),(0,r.mdx)("h3",{id:"batchplay"},"batchPlay"),(0,r.mdx)("p",null,"Photoshop is complex software, with many internal classes and methods. Not all of these are yet exposed via UXP. New interfaces are in development and will be shipped along with each release of Photoshop. In the meantime, if there is something your plugin or script needs to do that is not exposed in the current DOM, you may be able to use ",(0,r.mdx)("inlineCode",{parentName:"p"},"batchPlay"),"."),(0,r.mdx)("p",null,"BatchPlay is for accessing Photoshop functionality that has not yet been exposed via APIs. BatchPlay is a way to send multiple actions into the Photoshop event queue and return their results."),(0,r.mdx)("p",null,"ExtendScript has ",(0,r.mdx)("inlineCode",{parentName:"p"},"executeAction"),"; this is analagous to UXP's ",(0,r.mdx)("inlineCode",{parentName:"p"},"batchPlay"),". However, whereas ",(0,r.mdx)("inlineCode",{parentName:"p"},"executeAction")," could only play one descriptor at a time, ",(0,r.mdx)("inlineCode",{parentName:"p"},"batchPlay")," accepts an array of action descriptors. If you have multiple Photoshop operations that need to execute in series, using an array of action descriptors in a single ",(0,r.mdx)("inlineCode",{parentName:"p"},"batchPlay")," call is probably what you want."),(0,r.mdx)("p",null,"Unlike ExtendScript where classes were provided to construct action descriptors, references and values, ",(0,r.mdx)("inlineCode",{parentName:"p"},"batchPlay")," accepts plain JSON objects."),(0,r.mdx)("p",null,"The ",(0,r.mdx)("a",{parentName:"p",href:"/uxp-photoshop/ps_reference/media/batchplay/"},"batchPlay documentation")," contains details on how to construct JSON for ",(0,r.mdx)("inlineCode",{parentName:"p"},"batchPlay")," usage."),(0,r.mdx)("h2",{id:"uxp-scripting"},"UXP Scripting"),(0,r.mdx)("p",null,"UXP is not just for plugins anymore.  Individual JavaScript files may be developed and executed as detailed in the ",(0,r.mdx)("a",{parentName:"p",href:"./media/uxpscripting"},"UXP Scripting section"),"."))}d.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-ps-reference-index-md-b59fcf8f8e9df606b3c0.js.map